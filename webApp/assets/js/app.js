"use strict";angular.module("app",[]),angular.module("app",["ngRoute"]);var baseUrl="http://localhost:8080/";!function(){function e(e,t){var n=function(e){t.sessionStorage.token=e},o=function(){return t.sessionStorage.token},r=function(){t.sessionStorage.removeItem("token")},a=function(){var e=o();return e};return{saveToken:n,getToken:o,logout:r,isLoggedIn:a}}var t=angular.module("app");t.service("authentication",e),e.$inject=["$http","$window"]}();var app=angular.module("app");app.controller("loginCtrl",["$scope","userSvc","$location","authentication",function(e,t,n,o){e.message="",e.login=function(r,a){t.login(r,a).then(function(t){401===t.status?(e.message="*Invalid username or password!",e.username="",e.password="",$("#usrname").focus()):(o.saveToken(t.result.token),n.path("/profile"))})}}]);var app=angular.module("app");app.controller("profileController",["$scope","userSvc","authentication","$location",function(e,t,n,o){var r=window.sessionStorage.token;t.getUser(r,function(t){e.username=t.data.username}),e.logout=function(){n.logout(),o.path("/login")}}]),function(){function e(e,t){e.when("/",{templateUrl:"dashboard.html"}).when("/register",{templateUrl:"register.html"}).when("/login",{controller:"loginCtrl",templateUrl:"login.html"}).when("/profile",{templateUrl:"profile.html",controller:"profileController"}).when("/profile/adduser",{templateUrl:"adduser.html"})}function t(e,t,n){e.$on("$routeChangeStart",function(e,o,r){"/profile"!==t.path()||n.isLoggedIn()||t.path("/")})}var n=angular.module("app");n.config(["$routeProvider","$locationProvider",e]).run(["$rootScope","$location","authentication",t])}(),angular.module("app").service("userSvc",["$http",function(e){var t=this;t.getUser=function(t,n){e.get("/api/users/",{headers:{"X-Auth":t}}).then(function(e){n(e)})},t.login=function(n,o){return e.post("/api/sessions/",{username:n,password:o}).then(function(e){return t.token=e.data,{status:200,result:{token:t.token}}},function(e){return{status:401}})}}]);